# Map the records -----------------------------------------------------
# set colour group for maps and main panel plot title
if(z==1) {
colGroup = "a"
mainTitle = "Nitrogen-sensitive Lichen"
} else {
colGroup = "b"
mainTitle = "Nitrogen-tolerant Lichen"
}
# Produce maps
occurrenceMap(uk_map,df,colGroup,kdePlot = FALSE,plotTitle = indicatorSpp[a])
# Plot main panel plot title
if (a == 1) {
mtext(mainTitle,
side = 3, line = -0.14, outer = TRUE,col = c("#131713"),
font = 2,cex = 1.05, family = "lil")
}
rm(df)
}
}
source("C:/Users/Rose/lichen_mapping/occurrenceMap.R", echo = TRUE)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,1,0.1)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,1,0.1)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,1,5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,3,5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,5,5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,5,4)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,5,4)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,5,5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,5,5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil",cex = 0.3)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,5,5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Preparing data ----------------------------------------------------------
sdf = data.frame(df2$indicatorType,as.numeric(df2$decimalLongitude),
as.numeric(df2$decimalLatitude))
s = SpatialPointsDataFrame(data = na.omit(sdf),coords = sdf[,2:3])
# Calculating kernel density ----------------------------------------------
(ud <- kernelUD(s[,1], same4all = TRUE, grid = 10))
# Calculating difference --------------------------------------------------
udSensitive = raster(ud$nSensitive)
udTolerant = raster(ud$nTolerant)
compareRaster(udSensitive,udTolerant)
rastDiff = udSensitive - udTolerant
# Get masked difference --------------------------------------------------
projection(rastDiff) <- CRS("+init=EPSG:27700") # sets projection to British National Grid
maskedDiff = mask(rastDiff, uk_map)
# Plot difference --------------------------------------------------
op = par(font.lab = 2,mar=c(2,9,1,9)+0.1,xpd=FALSE, family = "lil")
fun_colour_range <- colorRampPalette(c("#c6787e","#d8dedd","#78C6C0"))
my_colours <- fun_colour_range(1000)
plot(st_geometry(uk_map),border="#f9fdf9",axes=TRUE,
xlim=c(-15,5),ylim=c(48.5,61.5),
col="#d8dedd",cex.axis=0.8)
plot(maskedDiff,col=my_colours, add = TRUE)
plot(st_geometry(uk_map),border="#f9fdf9",add = TRUE)
title(main = "Difference in lichen indicator spp. occurrence",family = "lil",cex.main = 1.1,line = -1)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,5,5.5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# --------------------------------------------------------------------------
#                 Maps of records from the NBN Atlas
# --------------------------------------------------------------------------
# Set graphical parameters for the maps
op = par(mfrow=c(2,4), font.lab = 2,
mar=c(2,2.5,1,0.1)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE)
# Get NBN Atlas data and map the records ----------------------------------
for (z in 1:2) {
if (z == 1){
indicatorSpp = nSensitive
} else {
indicatorSpp = nTolerant
}
for (a in 1:length(indicatorSpp)) {
# Get NBN Atlas data --------------------------------------------------
df = getNBNData(indicatorSpp[a],100)
# Map the records -----------------------------------------------------
# set colour group for maps and main panel plot title
if(z==1) {
colGroup = "a"
mainTitle = "Nitrogen-sensitive Lichen"
} else {
colGroup = "b"
mainTitle = "Nitrogen-tolerant Lichen"
}
# Produce maps
occurrenceMap(uk_map,df,colGroup,kdePlot = FALSE,plotTitle = indicatorSpp[a])
# Plot main panel plot title
if (a == 1) {
mtext(mainTitle,
side = 3, line = -0.14, outer = TRUE,col = c("#131713"),
font = 2,cex = 1.05, family = "lil")
}
rm(df)
}
}
# --------------------------------------------------------------------------
#                 Maps of records from the NBN Atlas
# --------------------------------------------------------------------------
# Set graphical parameters for the maps
op = par(mfrow=c(2,4), font.lab = 2,
mar=c(2,2.5,1,0.1)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE,family = "lil")
# Get NBN Atlas data and map the records ----------------------------------
for (z in 1:2) {
if (z == 1){
indicatorSpp = nSensitive
} else {
indicatorSpp = nTolerant
}
for (a in 1:length(indicatorSpp)) {
# Get NBN Atlas data --------------------------------------------------
df = getNBNData(indicatorSpp[a],100)
# Map the records -----------------------------------------------------
# set colour group for maps and main panel plot title
if(z==1) {
colGroup = "a"
mainTitle = "Nitrogen-sensitive Lichen"
} else {
colGroup = "b"
mainTitle = "Nitrogen-tolerant Lichen"
}
# Produce maps
occurrenceMap(uk_map,df,colGroup,kdePlot = FALSE,plotTitle = indicatorSpp[a])
# Plot main panel plot title
if (a == 1) {
mtext(mainTitle,
side = 3, line = -0.14, outer = TRUE,col = c("#131713"),
font = 2,cex = 1.05, family = "lil")
}
rm(df)
}
}
source("C:/Users/Rose/lichen_mapping/occurrenceMap.R", echo = TRUE)
# --------------------------------------------------------------------------
#                 Maps of records from the NBN Atlas
# --------------------------------------------------------------------------
# Set graphical parameters for the maps
op = par(mfrow=c(2,4), font.lab = 2,
mar=c(2,2.5,1,0.1)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE,family = "lil")
# Get NBN Atlas data and map the records ----------------------------------
for (z in 1:2) {
if (z == 1){
indicatorSpp = nSensitive
} else {
indicatorSpp = nTolerant
}
for (a in 1:length(indicatorSpp)) {
# Get NBN Atlas data --------------------------------------------------
df = getNBNData(indicatorSpp[a],100)
# Map the records -----------------------------------------------------
# set colour group for maps and main panel plot title
if(z==1) {
colGroup = "a"
mainTitle = "Nitrogen-sensitive Lichen"
} else {
colGroup = "b"
mainTitle = "Nitrogen-tolerant Lichen"
}
# Produce maps
occurrenceMap(uk_map,df,colGroup,kdePlot = FALSE,plotTitle = indicatorSpp[a])
# Plot main panel plot title
if (a == 1) {
mtext(mainTitle,
side = 3, line = -0.14, outer = TRUE,col = c("#131713"),
font = 2,cex = 1.05, family = "lil")
}
rm(df)
}
}
# Preparing data ----------------------------------------------------------
sdf = data.frame(df2$indicatorType,as.numeric(df2$decimalLongitude),
as.numeric(df2$decimalLatitude))
s = SpatialPointsDataFrame(data = na.omit(sdf),coords = sdf[,2:3])
# Calculating kernel density ----------------------------------------------
(ud <- kernelUD(s[,1], same4all = TRUE, grid = 10))
# Calculating difference --------------------------------------------------
udSensitive = raster(ud$nSensitive)
udTolerant = raster(ud$nTolerant)
compareRaster(udSensitive,udTolerant)
rastDiff = udSensitive - udTolerant
# Get masked difference --------------------------------------------------
projection(rastDiff) <- CRS("+init=EPSG:27700") # sets projection to British National Grid
maskedDiff = mask(rastDiff, uk_map)
# Plot difference --------------------------------------------------
op = par(font.lab = 2,mar=c(2,9,1,9)+0.1,xpd=FALSE, family = "lil")
fun_colour_range <- colorRampPalette(c("#c6787e","#d8dedd","#79c6c0"))
my_colours <- fun_colour_range(1000)
plot(st_geometry(uk_map),border="#f9fdf9",axes=TRUE,
xlim=c(-15,5),ylim=c(48.5,61.5),
col="#d8dedd",cex.axis=0.8)
plot(maskedDiff,col=my_colours, add = TRUE)
plot(st_geometry(uk_map),border="#f9fdf9",add = TRUE)
title(main = "Difference in lichen indicator spp. occurrence",family = "lil",cex.main = 1.1,line = -1)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2.5,5,5.5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(1.5,2.5,5,5.5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Plot the maps
op = par(mfrow=c(1,2), font.lab = 2,
mar=c(2,2,5,5.5)+0.1,
oma=c(0.01,0.01,2,0.01),xpd=FALSE, family = "lil")
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nSensitive",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "a", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Sensitive Spp."
)
occurrenceMap(uk_map,
sppDF = subset(df2,
indicatorType == "nTolerant",
select = c("decimalLongitude","decimalLatitude")),
colGroup = "b", pointsPlot = FALSE, kdePlot = TRUE,
plotTitle = "Nitrogen Tolerant Spp."
)
# Preparing data ----------------------------------------------------------
sdf = data.frame(df2$indicatorType,as.numeric(df2$decimalLongitude),
as.numeric(df2$decimalLatitude))
s = SpatialPointsDataFrame(data = na.omit(sdf),coords = sdf[,2:3])
# Calculating kernel density ----------------------------------------------
(ud <- kernelUD(s[,1], same4all = TRUE, grid = 10))
# Calculating difference --------------------------------------------------
udSensitive = raster(ud$nSensitive)
udTolerant = raster(ud$nTolerant)
compareRaster(udSensitive,udTolerant)
rastDiff = udSensitive - udTolerant
# Get masked difference --------------------------------------------------
projection(rastDiff) <- CRS("+init=EPSG:27700") # sets projection to British National Grid
maskedDiff = mask(rastDiff, uk_map)
# Plot difference --------------------------------------------------
op = par(font.lab = 2,mar=c(2,9,1,9)+0.1,xpd=FALSE, family = "lil")
fun_colour_range <- colorRampPalette(c("#c6787e","#d8dedd","#79c6c0"))
my_colours <- fun_colour_range(1000)
plot(st_geometry(uk_map),border="#f9fdf9",axes=TRUE,
xlim=c(-15,5),ylim=c(48.5,61.5),
col="#d8dedd",cex.axis=0.8)
plot(maskedDiff,col=my_colours, add = TRUE,cex = 0.3)
plot(st_geometry(uk_map),border="#f9fdf9",add = TRUE)
title(main = "Difference in lichen indicator spp. occurrence",family = "lil",cex.main = 1.1,line = -1)
# Preparing data ----------------------------------------------------------
sdf = data.frame(df2$indicatorType,as.numeric(df2$decimalLongitude),
as.numeric(df2$decimalLatitude))
s = SpatialPointsDataFrame(data = na.omit(sdf),coords = sdf[,2:3])
# Calculating kernel density ----------------------------------------------
(ud <- kernelUD(s[,1], same4all = TRUE, grid = 10))
# Calculating difference --------------------------------------------------
udSensitive = raster(ud$nSensitive)
udTolerant = raster(ud$nTolerant)
compareRaster(udSensitive,udTolerant)
rastDiff = udSensitive - udTolerant
# Get masked difference --------------------------------------------------
projection(rastDiff) <- CRS("+init=EPSG:27700") # sets projection to British National Grid
maskedDiff = mask(rastDiff, uk_map)
# Plot difference --------------------------------------------------
op = par(font.lab = 2,mar=c(2,9,1,9)+0.1,xpd=FALSE, family = "lil")
fun_colour_range <- colorRampPalette(c("#c6787e","#d8dedd","#79c6c0"))
my_colours <- fun_colour_range(1000)
plot(st_geometry(uk_map),border="#f9fdf9",axes=TRUE,
xlim=c(-15,5),ylim=c(48.5,61.5),
col="#d8dedd",cex.axis=0.8)
plot(maskedDiff,col=my_colours, add = TRUE)
plot(st_geometry(uk_map),border="#f9fdf9",add = TRUE)
title(main = "Difference in lichen indicator spp. occurrence",family = "lil",cex.main = 1.1,line = -1)
# Preparing data ----------------------------------------------------------
sdf = data.frame(df2$indicatorType,as.numeric(df2$decimalLongitude),
as.numeric(df2$decimalLatitude))
s = SpatialPointsDataFrame(data = na.omit(sdf),coords = sdf[,2:3])
# Calculating kernel density ----------------------------------------------
(ud <- kernelUD(s[,1], same4all = TRUE, grid = 10, verbose = FALSE))
# Preparing data ----------------------------------------------------------
sdf = data.frame(df2$indicatorType,as.numeric(df2$decimalLongitude),
as.numeric(df2$decimalLatitude))
s = SpatialPointsDataFrame(data = na.omit(sdf),coords = sdf[,2:3])
# Calculating kernel density ----------------------------------------------
(ud <- kernelUD(s[,1], same4all = TRUE, grid = 10))
# Calculating difference --------------------------------------------------
udSensitive = raster(ud$nSensitive)
udTolerant = raster(ud$nTolerant)
compareRaster(udSensitive,udTolerant)
rastDiff = udSensitive - udTolerant
# Get masked difference --------------------------------------------------
projection(rastDiff) <- CRS("+init=EPSG:27700") # sets projection to British National Grid
maskedDiff = mask(rastDiff, uk_map)
# Plot difference --------------------------------------------------
op = par(font.lab = 2,mar=c(2,9,1,9)+0.1,xpd=FALSE, family = "lil")
fun_colour_range <- colorRampPalette(c("#c6787e","#d8dedd","#79c6c0"))
my_colours <- fun_colour_range(1000)
plot(st_geometry(uk_map),border="#f9fdf9",axes=TRUE,
xlim=c(-15,5),ylim=c(48.5,61.5),
col="#d8dedd",cex.axis=0.8)
plot(maskedDiff,col=my_colours, add = TRUE)
plot(st_geometry(uk_map),border="#f9fdf9",add = TRUE)
title(main = "Difference in lichen indicator spp. occurrence",family = "lil",cex.main = 1.1,line = -1)
source("C:/Users/Rose/lichen_mapping/occurrenceMap.R", echo = TRUE)
